SELECT
'2021' AS 'SCHOOLYEAR',
CAST(MST.SE AS VARCHAR) + '_' + CAST(MST.SC AS VARCHAR) AS 'CLASSLOCALID',
CRS.CN AS 'COURSEID',
CRS.CO AS 'COURSENAME',
'' AS 'COURSESUBJECT',
CLASSNAME = (select TLN from TCH where MST.TN = TCH.TN and MST.SC = TCH.SC and TCH.DEL = 0 ) + '_' + CAST(MST.PD AS varchar) + '_'  + (SELECT CO FROM CRS WHERE MST.CN = CRS.CN),
'' AS 'CLASSDESCRIPTION',
MST.PD AS 'CLASSPERIOD',
'MDR' AS 'ORGANIZATIONTYPEID',
[ORGANIZATIONID] = CASE MST.SC
WHEN 10 THEN '00127361'
WHEN 15 THEN '01876802'
WHEN 20 THEN '01400348'
WHEN 21 THEN '01877105'
WHEN 30 THEN '00127282'
WHEN 31 THEN '00127309'
WHEN 32 THEN '05346122'
END,
MST.HI AS 'GRADE',
'' AS 'TERMID',
'ED' AS 'HMHAPPLICATIONS'
FROM MST
JOIN CRS ON (MST.CN = CRS.CN)
JOIN SEC ON (MST.SE = SEC.SE) AND (MST.SC = SEC.SC)
WHERE SEC.DEL = 0
AND SEC.SC = 20 AND SEC.SE IN (400,106,617,401,107,402,526,413,317,403,630,415,528,632,140,414,527,533,631,412,223,525)
OR SEC.SC = 21 AND SEC.SE IN (20,21,23,22,117,216,318,515,616,110,209,312,415,609,115,215,421,513,614,26,27)
OR SEC.SC = 10 AND SEC.SE IN (230,238,425,233,348,623,419,229,438)
OR SEC.SC = 30 AND SEC.SE IN (102,103,302,303,404,405)
OR SEC.SC = 31 AND SEC.SE IN (546,52,53,1144,570,48,47,49)
OR SEC.SC = 32 AND SEC.SE IN (106,107,206,207,305,404,505,506,605,606,105,204,312,410,510)
OR SEC.SC = 15 AND SEC.SE IN (22,34,43,3,23,46,44,45,100)
